{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Security headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://js.stripe.com https://checkout.flutterwave.com https://www.paypal.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <title>{% block title %}POGOSMARKETPLACE | Where your wants meet fulfilment{% endblock %}</title>
    
    <meta name="description" content="Premium Ecommerce Marketplace with thousands of products">
    
    <!-- Favicon -->
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    
    <!-- Preconnect for CDNs -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://js.stripe.com">
    
    <!-- Bootstrap 5 CSS -->
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet">
    
    <!-- Font Awesome 5 -->
    <link href="{% static 'fonts/fontawesome/css/all.min.css' %}" rel="stylesheet">
    
    <!-- Custom Styles -->
    <link href="{% static 'css/ui.css' %}" rel="stylesheet">
    <link href="{% static 'css/responsive.css' %}" rel="stylesheet" media="only screen and (max-width: 1200px)">
    
    <!-- Flatpickr CSS -->
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    
    {% block extra_head %}
    {% endblock %}
</head>

<body class="d-flex flex-column min-vh-100">
    {% include 'includes/navbar.html' %}
    
    <!-- Toast container for notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>
    
    <main role="main" class="container my-4 flex-grow-1">
        {% block breadcrumb %}
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                {% block breadcrumb_items %}{% endblock %}
            </ol>
        </nav>
        {% endblock %}
        
        <!-- Messages -->
        {% if messages %}
        <div class="container mb-4">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        {% block content %}
        {% endblock %}
    </main>
    
    {% include 'includes/footer.html' %}
    
    <!-- jQuery -->
    <script src="{% static 'js/jquery-2.0.0.min.js' %}"></script>
    
    <!-- Bootstrap Bundle JS -->
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    
    <!-- Payment SDKs - Load only when needed -->
    {% block payment_scripts %}
    <!-- Stripe -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Flutterwave -->
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    {% endblock %}
    
    <!-- PayPal SDK - Load only if client ID exists -->
    {% if paypal_client_id %}
    <script src="https://www.paypal.com/sdk/js?client-id={{ paypal_client_id }}&currency=USD" defer></script>
    {% endif %}
    
    <!-- Custom JS -->
    <script src="{% static 'js/script.js' %}" defer></script>
    
    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            flatpickr(".datepicker", {
                dateFormat: "Y-m-d",
                maxDate: "today",
                allowInput: true,
            });
        });
    </script>
    
    <!-- Global variables -->
    <script>
        // CSRF token for AJAX requests
        const csrfToken = "{{ csrf_token }}";
        // Currency settings
        const currencySymbol = "{{ CURRENCY_SYMBOL|default:'$' }}";
        // Cart and wishlist counts
        const cartCount = parseInt("{{ cart_count|default:0 }}");
        const wishlistCount = parseInt("{{ wishlist_count|default:0 }}");
    </script>
    
    {% block extra_js %}
    {% endblock %}
    
    {% block extra_scripts %}
    {% endblock %}
</body>
</html>